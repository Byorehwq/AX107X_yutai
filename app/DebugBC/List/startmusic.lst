##############################################################################
#                                                                            #
# IAR 8051 C/C++ Compiler V7.20H/W32                   27/Jun/2018  22:48:34 #
# Copyright 2004-2006 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Core               =  plain                                             #
#    Code model         =  near                                              #
#    Data model         =  large                                             #
#    Calling convention =  extended stack reentrant                          #
#    Constant location  =  code                                              #
#    Extended stack     =  enabled                                           #
#    Dptr setup         =  1,16                                              #
#    Source file        =  module/startmusic.c                               #
#    Command line       =  -f option_c51.cfg (-ICOMMON\ -IINC\ -Iconfig\     #
#                          -Iapi\ -Ifm\ -Ifat\ -Idisplay\                    #
#                          -Idisplay\theme_default\ -Idisplay\led\           #
#                          -Idisplay\lcd\ -Itask\ -Iuser\ -Imem\ -Imodule\   #
#                          -Ikey\ -Istartmusic\ -Ispi\ -e -z9 --core=plain   #
#                          --dptr=16,1 --data_model=large --code_model=near  #
#                          --calling_convention=ext_stack_reentrant          #
#                          --place_constants=code --nr_virtual_regs 20       #
#                          --extended_stack) -DAX207X_TAG --debug -lC        #
#                          DebugBC/List -o DebugBC/Obj/startmusic.r51        #
#                          module/startmusic.c                               #
#    List file          =  DebugBC/List/startmusic.lst                       #
#    Object file        =  DebugBC/Obj/startmusic.r51                        #
#                                                                            #
#                                                                            #
##############################################################################

R:\18BC073A_宇泰_AX1071_xxxxxxxx_20180627\app\module\startmusic.c
      1          /*****************************************************************************
      2           * Module    : Startmusic
      3           * File      : startmusic.c
      4           * Author    :
      5           * Email     :
      6           * Function  : 播放开机音乐
      7           *****************************************************************************/
      8          #include "include.h"
      9          
     10          #if PLAY_STARTMUSIC
     11          
     12          type_startmusic_ctl startmusic_ctl;
     13          
     14          #pragma location="STARTMUSIC_CONST"
     15          IAR_CONST u8 startmusic_table[] =
     16          {
     17          	0xFF,0xFB,0x30,0xC4,0x00,0x00,0x07,0x90,0x55,0x28,0x14,0x17,0x80,0x09,0x02,0x8D,
     18          
     19          	0x2D,0xB7,0x24,0xF0,0x02,0x18,0xC6,0x31,0x8D,0xFF,0x31,0x8C,0x74,0xA3,0x01,0x7C,
     20          
     21          	0x0B,0xC0,0x1D,0x00,0x58,0x0E,0x83,0xDC,0x07,0x40,0x0E,0x01,0x50,0x21,0x82,0xE0,
     22          
     23          	0x42,0x0B,0x81,0xD0,0xAC,0x67,0x7E,0xFD,0xFC,0x7B,0xBC,0x0C,0x3C,0x3C,0x3C,0x3C,
     24          
     25          	0x00,0x00,0x00,0x00,0x0C,0x3C,0x3C,0x3D,0xFF,0xFF,0xFA,0xFF,0xE0,0x00,0x78,0x78,
     26          
     27          	0x78,0xF9,0x75,0xBB,0x6B,0x10,0x88,0x6C,0xF6,0xD8,0x50,0x00,0x00,0x00,0x00,0x42,
     28          
     29          	0x36,0x20,0xF0,0x45,0x25,0xA0,0xE6,0xC8,0x9A,0x97,0x4B,0x88,0x29,0x59,0x42,0xE5,
     30          
     31          	0x27,0x98,0x5C,0x07,0x18,0x87,0xA3,0xCB,0x89,0x38,0xD8,0x06,0xE4,0xB2,0x64,0x6B,
     32          
     33          	0x53,0xE7,0xCE,0x32,0xE2,0x93,0xFF,0xF3,0x5D,0x6F,0xDA,0x00,0x95,0x17,0xA4,0x50,
     34          
     35          	0x03,0xF5,0xAA,0x32,0xC9,0x23,0x00,0x04,0xA1,0x60,0x00,0x18,0xFF,0xFB,0x32,0xC4,
     36          
     37          	0x04,0x80,0x08,0x9C,0xA1,0x5D,0xBC,0xCA,0x00,0x31,0x0B,0x13,0xEC,0x35,0x90,0xA2,
     38          
     39          	0x9E,0xF1,0xDA,0xD1,0x18,0xEC,0xD1,0x32,0x55,0x67,0xA5,0xC9,0x44,0x74,0xBE,0xB6,
     40          
     41          	0xD2,0x2F,0x11,0x61,0x7E,0x28,0x10,0x10,0xCC,0x0C,0xF1,0x01,0x24,0x10,0x04,0x73,
     42          
     43          	0x49,0xDF,0xCC,0x6E,0x8A,0xAC,0xA3,0x0A,0x28,0x26,0xC9,0x2D,0x05,0x9A,0x92,0x64,
     44          
     45          	0x14,0xB0,0x60,0xC5,0x82,0x7C,0x94,0x2D,0x37,0xFE,0xC8,0x9A,0x50,0xEC,0xD2,0x48,
     46          
     47          	0xC0,0x09,0x27,0x18,0x01,0x16,0x6F,0x48,0x77,0x7E,0x8D,0xCE,0x95,0x5E,0x9E,0x9E,
     48          
     49          	0xCB,0x93,0x93,0xB6,0x6B,0xCF,0x59,0xBD,0x7F,0x1E,0xD5,0xA0,0x14,0x04,0x7F,0xC7,
     50          
     51          	0xDA,0x43,0x96,0xFD,0xEC,0x62,0x20,0x24,0x54,0x10,0xED,0xAB,0x62,0x20,0x24,0xD7,
     52          
     53          	0x2F,0x71,0x4F,0x7C,0x31,0x00,0xFB,0x83,0x4F,0x69,0xB8,0x34,0xFF,0x04,0x1D,0x75,
     54          
     55          	0x77,0x5D,0x2C,0x80,0x07,0x2E,0xE0,0x00,0x35,0xFF,0xFB,0x32,0xC4,0x04,0x80,0x08,
     56          
     57          	0x78,0xA1,0x67,0xB4,0xF9,0x80,0x11,0x0C,0x95,0xEF,0x37,0x30,0xA0,0x02,0x30,0xD4,
     58          
     59          	0xAC,0x43,0xDB,0x19,0x5B,0xD5,0x0C,0xD3,0x4B,0x49,0x9C,0xE4,0xA4,0x33,0x53,0x72,
     60          
     61          	0x7C,0xBD,0x41,0x21,0x78,0x08,0xEA,0x44,0x88,0x9A,0x69,0xBF,0xD1,0x73,0x46,0xD9,
     62          
     63          	0xCE,0xA9,0x14,0xD4,0xCB,0x5A,0xD2,0x75,0xA2,0x8B,0x3A,0x92,0x45,0xBA,0xD1,0x35,
     64          
     65          	0x45,0xEB,0x75,0x9B,0x11,0x66,0xB2,0xC6,0x27,0x7D,0xF6,0xF7,0x32,0x80,0x16,0xCF,
     66          
     67          	0xFE,0xBA,0xE0,0x00,0x00,0x00,0x09,0x93,0x5C,0xB5,0xB5,0x26,0x33,0xB7,0x0F,0xCA,
     68          
     69          	0xB1,0xCF,0xF2,0x94,0x56,0xEF,0x6C,0x38,0x81,0x95,0x94,0x02,0xB8,0xCA,0x00,0xD1,
     70          
     71          	0xE9,0x8F,0x62,0x02,0x71,0xEB,0x8A,0xA3,0x10,0x58,0x62,0x68,0xF6,0xE4,0x4F,0xAD,
     72          
     73          	0xF3,0x47,0xEF,0x5F,0x43,0x7E,0x6B,0xB2,0xBD,0xDB,0xF2,0xCA,0x6D,0xC9,0x2C,0x6D,
     74          
     75          	0x2D,0xD2,0xC7,0x19,0x99,0x8F,0xFF,0xFB,0x32,0xC4,0x05,0x03,0xC7,0x9C,0x3D,0x4D,
     76          
     77          	0x9C,0x33,0x00,0x30,0x00,0x00,0x34,0x80,0x00,0x00,0x04,0x5F,0xA0,0x20,0x20,0x2A,
     78          
     79          	0xA4,0x69,0x12,0x38,0x70,0x08,0x96,0xF7,0x35,0x11,0x80,0xD3,0xE2,0x20,0x69,0x60,
     80          
     81          	0xB0,0x34,0xF5,0x82,0xA0,0xD1,0xED,0x40,0xD0,0x34,0xB0,0x54,0x1A,0xEA,0x06,0x9F,
     82          
     83          	0x58,0x88,0x1A,0x89,0x41,0x67,0xD6,0x0A,0xB3,0x84,0xB8,0x2B,0xFF,0x3D,0x4C,0x41,
     84          
     85          	0x4D,0x45,0x33,0x2E,0x39,0x39,0x2E,0x35,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
     86          
     87          	0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
     88          
     89          	0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
     90          
     91          	0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
     92          
     93          	0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
     94          
     95          	0x55,0x55,0x55,
     96          
     97          	0xFF,0xFB,0x30,0xC4,0x00,0x00,0x07,0x90,0x55,0x28,0x14,0x17,0x80,0x09,0x02,0x8D,
     98          
     99          	0x2D,0xB7,0x24,0xF0,0x02,0x18,0xC6,0x31,0x8D,0xFF,0x31,0x8C,0x74,0xA3,0x01,0x7C,
    100          
    101          	0x0B,0xC0,0x1D,0x00,0x58,0x0E,0x83,0xDC,0x07,0x40,0x0E,0x01,0x50,0x21,0x82,0xE0,
    102          
    103          	0x42,0x0B,0x81,0xD0,0xAC,0x67,0x7E,0xFD,0xFC,0x7B,0xBC,0x0C,0x3C,0x3C,0x3C,0x3C,
    104          
    105          	0x00,0x00,0x00,0x00,0x0C,0x3C,0x3C,0x3D,0xFF,0xFF,0xFA,0xFF,0xE0,0x00,0x78,0x78,
    106          
    107          	0x78,0xF9,0x75,0xBB,0x6B,0x10,0x88,0x6C,0xF6,0xD8,0x50,0x00,0x00,0x00,0x00,0x42,
    108          
    109          	0x36,0x20,0xF0,0x45,0x25,0xA0,0xE6,0xC8,0x9A,0x97,0x4B,0x88,0x29,0x59,0x42,0xE5,
    110          
    111          	0x27,0x98,0x5C,0x07,0x18,0x87,0xA3,0xCB,0x89,0x38,0xD8,0x06,0xE4,0xB2,0x64,0x6B,
    112          
    113          	0x53,0xE7,0xCE,0x32,0xE2,0x93,0xFF,0xF3,0x5D,0x6F,0xDA,0x00,0x95,0x17,0xA4,0x50,
    114          
    115          	0x03,0xF5,0xAA,0x32,0xC9,0x23,0x00,0x04,0xA1,0x60,0x00,0x18,0xFF,0xFB,0x32,0xC4,
    116          
    117          	0x04,0x80,0x08,0x9C,0xA1,0x5D,0xBC,0xCA,0x00,0x31,0x0B,0x13,0xEC,0x35,0x90,0xA2,
    118          
    119          	0x9E,0xF1,0xDA,0xD1,0x18,0xEC,0xD1,0x32,0x55,0x67,0xA5,0xC9,0x44,0x74,0xBE,0xB6,
    120          
    121          	0xD2,0x2F,0x11,0x61,0x7E,0x28,0x10,0x10,0xCC,0x0C,0xF1,0x01,0x24,0x10,0x04,0x73,
    122          
    123          	0x49,0xDF,0xCC,0x6E,0x8A,0xAC,0xA3,0x0A,0x28,0x26,0xC9,0x2D,0x05,0x9A,0x92,0x64,
    124          
    125          	0x14,0xB0,0x60,0xC5,0x82,0x7C,0x94,0x2D,0x37,0xFE,0xC8,0x9A,0x50,0xEC,0xD2,0x48,
    126          
    127          	0xC0,0x09,0x27,0x18,0x01,0x16,0x6F,0x48,0x77,0x7E,0x8D,0xCE,0x95,0x5E,0x9E,0x9E,
    128          
    129          	0xCB,0x93,0x93,0xB6,0x6B,0xCF,0x59,0xBD,0x7F,0x1E,0xD5,0xA0,0x14,0x04,0x7F,0xC7,
    130          
    131          	0xDA,0x43,0x96,0xFD,0xEC,0x62,0x20,0x24,0x54,0x10,0xED,0xAB,0x62,0x20,0x24,0xD7,
    132          
    133          	0x2F,0x71,0x4F,0x7C,0x31,0x00,0xFB,0x83,0x4F,0x69,0xB8,0x34,0xFF,0x04,0x1D,0x75,
    134          
    135          	0x77,0x5D,0x2C,0x80,0x07,0x2E,0xE0,0x00,0x35,0xFF,0xFB,0x32,0xC4,0x04,0x80,0x08,
    136          
    137          	0x78,0xA1,0x67,0xB4,0xF9,0x80,0x11,0x0C,0x95,0xEF,0x37,0x30,0xA0,0x02,0x30,0xD4,
    138          
    139          	0xAC,0x43,0xDB,0x19,0x5B,0xD5,0x0C,0xD3,0x4B,0x49,0x9C,0xE4,0xA4,0x33,0x53,0x72,
    140          
    141          	0x7C,0xBD,0x41,0x21,0x78,0x08,0xEA,0x44,0x88,0x9A,0x69,0xBF,0xD1,0x73,0x46,0xD9,
    142          
    143          	0xCE,0xA9,0x14,0xD4,0xCB,0x5A,0xD2,0x75,0xA2,0x8B,0x3A,0x92,0x45,0xBA,0xD1,0x35,
    144          
    145          	0x45,0xEB,0x75,0x9B,0x11,0x66,0xB2,0xC6,0x27,0x7D,0xF6,0xF7,0x32,0x80,0x16,0xCF,
    146          
    147          	0xFE,0xBA,0xE0,0x00,0x00,0x00,0x09,0x93,0x5C,0xB5,0xB5,0x26,0x33,0xB7,0x0F,0xCA,
    148          
    149          	0xB1,0xCF,0xF2,0x94,0x56,0xEF,0x6C,0x38,0x81,0x95,0x94,0x02,0xB8,0xCA,0x00,0xD1,
    150          
    151          	0xE9,0x8F,0x62,0x02,0x71,0xEB,0x8A,0xA3,0x10,0x58,0x62,0x68,0xF6,0xE4,0x4F,0xAD,
    152          
    153          	0xF3,0x47,0xEF,0x5F,0x43,0x7E,0x6B,0xB2,0xBD,0xDB,0xF2,0xCA,0x6D,0xC9,0x2C,0x6D,
    154          
    155          	0x2D,0xD2,0xC7,0x19,0x99,0x8F,0xFF,0xFB,0x32,0xC4,0x05,0x03,0xC7,0x9C,0x3D,0x4D,
    156          
    157          	0x9C,0x33,0x00,0x30,0x00,0x00,0x34,0x80,0x00,0x00,0x04,0x5F,0xA0,0x20,0x20,0x2A,
    158          
    159          	0xA4,0x69,0x12,0x38,0x70,0x08,0x96,0xF7,0x35,0x11,0x80,0xD3,0xE2,0x20,0x69,0x60,
    160          
    161          	0xB0,0x34,0xF5,0x82,0xA0,0xD1,0xED,0x40,0xD0,0x34,0xB0,0x54,0x1A,0xEA,0x06,0x9F,
    162          
    163          	0x58,0x88,0x1A,0x89,0x41,0x67,0xD6,0x0A,0xB3,0x84,0xB8,0x2B,0xFF,0x3D,0x4C,0x41,
    164          
    165          	0x4D,0x45,0x33,0x2E,0x39,0x39,0x2E,0x35,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
    166          
    167          	0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
    168          
    169          	0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
    170          
    171          	0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
    172          
    173          	0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
    174          
    175          	0x55,0x55,0x55,
    176          
    177          };
    178          
    179          
    180          //播放开机音乐
    181          #pragma location="STARTMUSIC_SEG"
    182          void startmusic_play(void)
    183          {
    184              startmusic_init();
    185              mute_disable();
    186          #if WAV_SUPPORT
    187              if (music_init() == TYPE_MP3)  //只支持MP3格式
    188          #else
    189              if (music_init_mp3_only() == TYPE_MP3)  //只支持MP3格式
    190          #endif
    191              {
    192                  music_play();
    193          		music_play();
    194              }
    195          
    196              while (music_get_status() > STATUS_PLAY_STOPPING) {
    197                  WATCHDOG_CLR();
    198                  music_event();
    199              }
    200              music_stop();
    201              mute_enable();
    202              startmusic_ctl.flag = 0;
    203          }
    204          
    205          //开机音初始化
    206          #pragma location="STARTMUSIC_SEG"
    207          void startmusic_init(void)
    208          {
    209              startmusic_ctl.flag = 1;
    210              msc_ctl.mscfade_en = 1;
    211              startmusic_ctl.ofs = 0;
    212              startmusic_ctl.len = (sizeof(startmusic_table))/512;
    213          }
    214          
    215          //开机音读接口
    216          #pragma location="STARTMUSIC_SEG"
    217          bool startmusic_read(void *buf)
    218          {
    219              if(startmusic_ctl.ofs >= startmusic_ctl.len) {
    220                  return false;
    221              }
    222          	if(sys_ctl.mode_play != ITEM_LOOP_SINGLE)
    223          	{
    224          	    for (u16 i=0; i<627; i++)
    225          		{
    226          	        ((u8 *)buf)[i] = startmusic_table[i + (u16)startmusic_ctl.ofs * 627];
    227          	    }
    228          	}
    229          	else
    230          	{
    231          		for (u16 i=0; i<1524; i++)
    232          		{
    233          	        ((u8 *)buf)[i] = startmusic_table[i + (u16)startmusic_ctl.ofs * 1524];
    234          	    }
    235          	}
    236              startmusic_ctl.ofs++;
    237              return true;
    238          }
    239          
    240          //开机音seek接口
    241          #pragma location="STARTMUSIC_SEG"
    242          bool startmusic_seek(void)
    243          {
    244              startmusic_ctl.ofs = 0;
    245              return true;
    246          }
    247          #endif
    248          


   Segment part sizes:

     Function/Label Bytes
     -------------- -----

 
 
 0 bytes of memory

Errors: none
Warnings: none
